# Palvelinten Hallinta 


MacBook Air M2 8 cores, 8GB RAM, 256GB SSD

MacOS Sonoma 14.4 (64-bittinen, Apple Silicon)

QEMU 9.1 ARM Virtual Machine UTM:n kautta

# h4 Pkg-file-service

# x)

- Artikkeli käsittelee, miten konfigurointityökalu SaltStack:ia käytetään demonien hallintaan ja asennetaan paketti, korvataan konfiguraatiotiedosto ja
  tarvittaessa käynnistetään palvelu uudelleen.

- Konfiguraatiotiedosto sshd_config määrittelee muun muassa Port 8888 asetuksen, jolloin SSH-palvelin kuuntelee portissa 8888

- Lopuksi master-palvelimelta komento salt '*' state.apply sshd levittää tilan kaikille alaisille agenteille ja SSH-yhteys testataan uudella portilla¨

# a) 

Ping toimii masterin ja minionin välillä 


<img width="593" height="258" alt="ping toimii masterin ja minionin välillä" src="https://github.com/user-attachments/assets/94922f36-ac8a-438c-b4c0-72d184d2bb76" />


Sitten ssh konfiguraatio tiedosto


<img width="553" height="335" alt="sshd config tiedosto" src="https://github.com/user-attachments/assets/69e65da0-2f92-4f50-8fc1-6dd85a3a336a" />


#### sudo ss -tulpn | grep ssh

<img width="1301" height="168" alt="Screenshot 2025-11-17 at 15 46 45" src="https://github.com/user-attachments/assets/b4ecdfa5-0a60-44f7-bc32-a165ac398e8f" />


Sitten /srv/salt/ssh kansiosta init.sls

<img width="434" height="446" alt="Screenshot 2025-11-17 at 15 49 18" src="https://github.com/user-attachments/assets/71f87135-33cb-429d-b4dd-5647ccb64136" />


#### sudo salt '*' state.apply ssh

ssh loppuun koska minulla ssh kansiossa init.sls, olisin voinut top.sls tehdä base säännöllä eri tavalla, mutta tein nyt näin 

<img width="283" height="278" alt="Screenshot 2025-11-12 at 18 44 37" src="https://github.com/user-attachments/assets/9a8316d7-27f1-4536-af47-cd8768e9bc65" />


siinä poistan paketteja

<img width="896" height="350" alt="Screenshot 2025-11-12 at 18 50 18" src="https://github.com/user-attachments/assets/28fa7315-cd48-494a-a8cf-055ecdc9445e" />

siinä ajan tilani uudelleen ja kuten voi huomata se toimii!

<img width="588" height="676" alt="Screenshot 2025-11-12 at 18 50 47" src="https://github.com/user-attachments/assets/4ece7763-bc15-4d53-99d2-a6bd817ed9c5" />

# b) Apache tehtävä

apache on jo valmiiksi asennettu koneelle 

/etc/apache2/sites-available/nettisivu.conf

siellä kaksi name based virtualhostia, jossa servernamet on eri 

sekä hyvä muistaa, että hakemistot mistä eri hostit hakee tietoja on eri 

<img width="951" height="655" alt="Screenshot 2025-11-17 at 16 11 22" src="https://github.com/user-attachments/assets/c6a1973c-a2f4-4a61-874c-38e4f84891b0" />

tässä molempien omat index.html tiedostot

<img width="439" height="155" alt="Screenshot 2025-11-17 at 16 12 57" src="https://github.com/user-attachments/assets/33e28f98-cc2b-4e62-a633-0fc2e8ab7e80" />

eli ensiksi localhost, mikä tulee sieltä 000-default tiedostosta

<img width="997" height="455" alt="Screenshot 2025-11-17 at 16 17 41" src="https://github.com/user-attachments/assets/8085ebee-ca21-4f34-b7be-40ceefbf2c1e" />

<img width="740" height="408" alt="Screenshot 2025-11-17 at 16 18 35" src="https://github.com/user-attachments/assets/7de6424f-9486-4e70-b8c1-7aa80e384c92" />

sitten kaksi eri name based hostia 

"nettisivu"

<img width="726" height="372" alt="Screenshot 2025-11-17 at 16 21 01" src="https://github.com/user-attachments/assets/196028ff-f616-4878-a516-96a2f1d3354a" />


"nettisivu1"

<img width="660" height="373" alt="Screenshot 2025-11-17 at 16 21 35" src="https://github.com/user-attachments/assets/df81b089-5a3b-4a20-b636-f236d1d2d3f2" />

tässä vielä kerran mistä se hakee index.html 

<img width="439" height="155" alt="Screenshot 2025-11-17 at 16 12 57" src="https://github.com/user-attachments/assets/70c7543b-51f9-41ec-b115-5b6c15a08447" />

ja esimerkkinä nettisivu kansion index.html, pystyy muokkaamaan käyttäjän oikeuksin ilman sudoa

<img width="680" height="39" alt="Screenshot 2025-11-17 at 16 25 19" src="https://github.com/user-attachments/assets/aa37538a-833b-416a-88f1-b0aeaee99413" />


# Lähteet

https://terokarvinen.com/2018/04/03/pkg-file-service-control-daemons-with-salt-change-ssh-server-port/?fromSearch=karvinen%20salt%20ssh


https://httpd.apache.org/docs/2.4/vhosts/name-based.html





